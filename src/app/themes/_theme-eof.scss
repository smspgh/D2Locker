// Edge of Fate - Destiny 2 Theme
// Inspired by The Nine: 4-dimensional dark matter entities from the edge of the solar system

// --- SCSS Variables (for theme definition) ---
$font-primary: 'Exo 2', sans-serif;
$transition-speed: 0.3s;

// Enhanced Palette - The Nine Aesthetic
$deep-space: #050a15; // Deeper void for dark matter realm
$void-nebula: #0f1624; // Darker nebula with Nine influence
$dark-matter-purple: #1a0f2e; // The Nine's dimensional influence
$gravitational-blue: #0d1f3a; // Gravitational well effects
$paracausal-cyan: #00f2de; // Original paracausal energy
$nine-silver: #b8c5d1; // Mysterious Nine communications
$cosmic-gold: #ffa726; // Refined molten gold
$starlight-white: #e8edf7; // Brighter starlight
$debris-grey: #5a6b7a; // Cooler debris tone
$dark-matter-glow: #2d1b3d; // Dark matter particle effects

.theme-edge-of-fate {
  // --- CSS Custom Properties (for app consumption) ---

  // Base colours - Enhanced with Nine influence
  --theme-accent-primary: #{$cosmic-gold}; // The Nine's golden communications
  --theme-accent-secondary: #{$paracausal-cyan}; // Paracausal energy signatures
  --theme-accent-tertiary: #{$nine-silver}; // Nine's mysterious silver tones

  // Fills for modals, popups, etc. - Dark matter aesthetics
  --theme-fill-modal: #{rgba($dark-matter-purple, 0.85)};
  --theme-fill-modal-actions: #{$void-nebula}; // Dimensional layers
  --theme-fill-modal-nine: #{rgba($gravitational-blue, 0.6)}; // Nine influence overlay

  // Text - Cosmic communications
  --theme-text: #{$starlight-white};
  --theme-text-invert: #{$deep-space};
  --theme-text-secondary: #{$nine-silver};
  --theme-text-nine: #{$paracausal-cyan}; // Nine entity text

  // Buttons
  --theme-button-bg: var(--theme-accent-primary);
  --theme-button-text: var(--theme-text-invert);

  // Input fields
  --theme-input-bg: #{$deep-space};

  // Shadows - Dark matter particle effects
  --theme-drop-shadow:
    0 0 25px #{rgba($dark-matter-glow, 0.4)}, 0 0 15px #{rgba($paracausal-cyan, 0.1)};
  --theme-nine-glow: 0 0 30px #{rgba($nine-silver, 0.2)}, 0 0 15px #{rgba($cosmic-gold, 0.1)};
  --theme-dimensional-shadow: 0 5px 20px #{rgba($dark-matter-purple, 0.6)};

  // Tooltips (Styled to match the new theme)
  --theme-tooltip-underline: var(--theme-accent-secondary);
  --theme-tooltip-header-bg: #{$deep-space};
  --theme-tooltip-body-bg: #{$void-nebula};
  --theme-tooltip-border: #{rgba($paracausal-cyan, 0.5)};
  --theme-tooltip-minimal-bg: #{$void-nebula};

  // App background - Edge of solar system with Nine influence
  --theme-app-bg-gradient-start: #{$gravitational-blue};
  --theme-app-bg-gradient-mid: #{$dark-matter-purple};
  --theme-app-bg-gradient-end: #{$deep-space};
  --theme-app-bg-gradient: radial-gradient(
    ellipse at top left,
    var(--theme-app-bg-gradient-start) 0%,
    var(--theme-app-bg-gradient-mid) 35%,
    var(--theme-app-bg-gradient-end) 70%
  );
  --theme-app-bg-nine: conic-gradient(
    from 45deg at 80% 20%,
    transparent 0deg,
    #{rgba($dark-matter-glow, 0.1)} 90deg,
    transparent 180deg,
    #{rgba($nine-silver, 0.05)} 270deg,
    transparent 360deg
  );
  --theme-app-bg: var(--theme-app-bg-gradient), var(--theme-app-bg-nine);
  --theme-section-bg: var(--theme-fill-modal-actions);
  --theme-pwa-background: #{$deep-space};

  // Header
  --theme-header-nav-bg: #{rgba($deep-space, 0.8)};
  --theme-header-nav-slideout-menu-bg: var(--theme-fill-modal);
  --theme-header-characters-bg: #{$deep-space};
  --theme-header-characters-txt: var(--theme-text-secondary);

  // Dropdown menu
  --theme-dropdown-menu-bg: var(--theme-fill-modal);

  // Search
  --theme-search-bg: #{rgba($starlight-white, 0.1)};
  --theme-search-dropdown-bg: var(--theme-fill-modal-actions);
  --theme-search-dropdown-border: var(--theme-accent-secondary);

  // Items 'polaroid' framed icons - Nine dimensional aesthetics
  --theme-item-polaroid: #{$void-nebula};
  --theme-item-polaroid-txt: var(--theme-text);
  --theme-item-polaroid-masterwork: #{$cosmic-gold};
  --theme-item-polaroid-masterwork-txt: #{$deep-space};
  --theme-item-polaroid-capped: #e74c3c;
  --theme-item-polaroid-capped-txt: #fff;
  --theme-item-polaroid-godroll: #{$paracausal-cyan};
  --theme-item-polaroid-trashroll: #c0392b;
  --theme-item-polaroid-nine: #{$nine-silver}; // Nine-touched items
  --theme-item-polaroid-element-adjust-brightness: 105%;

  // Item popup
  --theme-item-popup-border: var(--theme-accent-secondary);
  --theme-item-popup-arrow: var(--theme-accent-secondary);
  --theme-item-popup-actions-bg: var(--theme-fill-modal-actions);
  --theme-item-popup-panel-bg: #{rgba($starlight-white, 0.06)};
  --theme-item-popup-progress-bar-bg: #{rgba($deep-space, 0.3)};

  // Item feed & sheet
  --theme-item-feed-bg: var(--theme-fill-modal);
  --theme-item-sheet-bg: var(--theme-fill-modal);

  // Organizer
  --theme-organizer-row-odd-bg: #{rgba($void-nebula, 0.2)};
  --theme-organizer-row-even-bg: #{rgba($void-nebula, 0.4)};

  // Records
  --theme-record-redeemed: #{$molten-gold};

  // P3 colourspace tints for displays that support them - Enhanced cosmic colors
  @supports (color: color(display-p3 1 1 1)) {
    --theme-accent-primary: oklch(78% 0.18 82); // Cosmic Gold
    --theme-accent-secondary: oklch(89% 0.23 192); // Paracausal Cyan
    --theme-accent-tertiary: oklch(76% 0.05 240); // Nine Silver
  }

  // Dark matter particle animations
  &::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
    background:
      radial-gradient(circle at 20% 30%, #{rgba($dark-matter-glow, 0.02)} 0%, transparent 50%),
      radial-gradient(circle at 80% 70%, #{rgba($nine-silver, 0.01)} 0%, transparent 60%),
      radial-gradient(circle at 40% 80%, #{rgba($paracausal-cyan, 0.01)} 0%, transparent 40%);
    animation: cosmic-drift 120s infinite linear;
  }

  // Nine dimensional rifts
  &::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
    background: conic-gradient(
      from 0deg at 85% 15%,
      transparent 0deg,
      #{rgba($gravitational-blue, 0.03)} 45deg,
      transparent 90deg,
      #{rgba($dark-matter-purple, 0.02)} 180deg,
      transparent 270deg
    );
    animation: dimensional-shift 180s infinite ease-in-out;
  }
}

// --- Global Styles & Animations ---
@keyframes cosmic-drift {
  0% {
    transform: rotate(0deg) translateX(0) translateY(0);
  }
  33% {
    transform: rotate(120deg) translateX(20px) translateY(-10px);
  }
  66% {
    transform: rotate(240deg) translateX(-15px) translateY(25px);
  }
  100% {
    transform: rotate(360deg) translateX(0) translateY(0);
  }
}

@keyframes dimensional-shift {
  0% {
    transform: rotate(0deg) scale(1);
    opacity: 0.6;
  }
  25% {
    transform: rotate(90deg) scale(1.02);
    opacity: 0.8;
  }
  50% {
    transform: rotate(180deg) scale(0.98);
    opacity: 0.4;
  }
  75% {
    transform: rotate(270deg) scale(1.01);
    opacity: 0.7;
  }
  100% {
    transform: rotate(360deg) scale(1);
    opacity: 0.6;
  }
}

@keyframes nine-glow {
  0%,
  100% {
    text-shadow:
      0 0 8px rgba($paracausal-cyan, 0.4),
      0 0 16px rgba($nine-silver, 0.2);
  }
  50% {
    text-shadow:
      0 0 12px rgba($paracausal-cyan, 0.6),
      0 0 24px rgba($cosmic-gold, 0.3);
  }
}

@keyframes gravitational-pulse {
  0%,
  100% {
    box-shadow: var(--theme-drop-shadow);
  }
  50% {
    box-shadow: var(--theme-nine-glow);
  }
}

body.theme-edge-of-fate {
  background-color: $deep-space;
  background-image: var(--theme-app-bg);
  color: var(--theme-text);
  font-family: $font-primary;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  position: relative;
  overflow-x: hidden;

  // Enhanced cosmic text styling
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: var(--theme-accent-secondary);
    letter-spacing: 1.2px;
    text-shadow:
      0 0 8px rgba($paracausal-cyan, 0.4),
      0 0 16px rgba($nine-silver, 0.1);
    animation: nine-glow 6s ease-in-out infinite;

    &:hover {
      text-shadow:
        0 0 12px rgba($paracausal-cyan, 0.7),
        0 0 24px rgba($cosmic-gold, 0.3);
    }
  }

  // Nine-influenced links
  a {
    color: var(--theme-accent-primary);
    text-decoration: none;
    transition: all $transition-speed ease;
    position: relative;

    &:hover {
      color: var(--theme-accent-secondary);
      text-shadow: 0 0 6px rgba($paracausal-cyan, 0.5);
      text-decoration: underline;
    }

    &:focus {
      outline: 2px solid rgba($nine-silver, 0.5);
      outline-offset: 2px;
    }
  }

  // Dark matter influence on interactive elements
  button,
  .clickable {
    transition: all $transition-speed ease;

    &:hover {
      box-shadow: var(--theme-nine-glow);
      transform: translateY(-1px);
    }
  }

  // Scrollbar styling for the Nine aesthetic
  ::-webkit-scrollbar {
    width: 8px;
    background: rgba($dark-matter-purple, 0.3);
  }

  ::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, $cosmic-gold, $paracausal-cyan);
    border-radius: 4px;

    &:hover {
      background: linear-gradient(180deg, $nine-silver, $paracausal-cyan);
    }
  }
}
